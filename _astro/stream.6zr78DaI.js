import{a8 as b,K as $,ae as Y,C as J,f as X}from"./index.browser.esm.CTDr-V4f.js";import{c as ee,_ as O,E as G,S as te,a as re,O as F,e as E,b as ne,d as oe,p as ie,f as ae,o as T,m as se,g as ue,h as I,i as R,j as H,k as W,l as L,t as le,n as ce,u as fe,q as K,B as pe,U as d,F as U,s as k,r as N,v as M,w as A,x as de,y as ve}from"./binary-layout.WYS2KboB.js";import{q as he,u as _e}from"./solana-wallets-vue.B0V3fLTR.js";var be=ee(function(n){return function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),S=function(n){O(r,n);function r(){var e=n.call(this)||this;return e.closed=!1,e.currentObservers=null,e.observers=[],e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return r.prototype.lift=function(e){var t=new B(this,this);return t.operator=e,t},r.prototype._throwIfClosed=function(){if(this.closed)throw new be},r.prototype.next=function(e){var t=this;E(function(){var o,i;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var s=ne(t.currentObservers),a=s.next();!a.done;a=s.next()){var u=a.value;u.next(e)}}catch(f){o={error:f}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}}})},r.prototype.error=function(e){var t=this;E(function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var o=t.observers;o.length;)o.shift().error(e)}})},r.prototype.complete=function(){var e=this;E(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}})},r.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(r.prototype,"observed",{get:function(){var e;return((e=this.observers)===null||e===void 0?void 0:e.length)>0},enumerable:!1,configurable:!0}),r.prototype._trySubscribe=function(e){return this._throwIfClosed(),n.prototype._trySubscribe.call(this,e)},r.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},r.prototype._innerSubscribe=function(e){var t=this,o=this,i=o.hasError,s=o.isStopped,a=o.observers;return i||s?G:(this.currentObservers=null,a.push(e),new te(function(){t.currentObservers=null,re(a,e)}))},r.prototype._checkFinalizedStatuses=function(e){var t=this,o=t.hasError,i=t.thrownError,s=t.isStopped;o?e.error(i):s&&e.complete()},r.prototype.asObservable=function(){var e=new F;return e.source=this,e},r.create=function(e,t){return new B(e,t)},r}(F),B=function(n){O(r,n);function r(e,t){var o=n.call(this)||this;return o.destination=e,o.source=t,o}return r.prototype.next=function(e){var t,o;(o=(t=this.destination)===null||t===void 0?void 0:t.next)===null||o===void 0||o.call(t,e)},r.prototype.error=function(e){var t,o;(o=(t=this.destination)===null||t===void 0?void 0:t.error)===null||o===void 0||o.call(t,e)},r.prototype.complete=function(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)},r.prototype._subscribe=function(e){var t,o;return(o=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&o!==void 0?o:G},r}(S),z=function(n){O(r,n);function r(e){var t=n.call(this)||this;return t._value=e,t}return Object.defineProperty(r.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),r.prototype._subscribe=function(e){var t=n.prototype._subscribe.call(this,e);return!t.closed&&e.next(this._value),t},r.prototype.getValue=function(){var e=this,t=e.hasError,o=e.thrownError,i=e._value;if(t)throw o;return this._throwIfClosed(),i},r.prototype.next=function(e){n.prototype.next.call(this,this._value=e)},r}(S),me=function(n){O(r,n);function r(e,t,o){e===void 0&&(e=1/0),t===void 0&&(t=1/0),o===void 0&&(o=oe);var i=n.call(this)||this;return i._bufferSize=e,i._windowTime=t,i._timestampProvider=o,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=t===1/0,i._bufferSize=Math.max(1,e),i._windowTime=Math.max(1,t),i}return r.prototype.next=function(e){var t=this,o=t.isStopped,i=t._buffer,s=t._infiniteTimeWindow,a=t._timestampProvider,u=t._windowTime;o||(i.push(e),!s&&i.push(a.now()+u)),this._trimBuffer(),n.prototype.next.call(this,e)},r.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),o=this,i=o._infiniteTimeWindow,s=o._buffer,a=s.slice(),u=0;u<a.length&&!e.closed;u+=i?1:2)e.next(a[u]);return this._checkFinalizedStatuses(e),t},r.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,o=e._timestampProvider,i=e._buffer,s=e._infiniteTimeWindow,a=(s?1:2)*t;if(t<1/0&&a<i.length&&i.splice(0,i.length-a),!s){for(var u=o.now(),f=0,c=1;c<i.length&&i[c]<=u;c+=2)f=c;f&&i.splice(0,f+1)}},r}(S),we=Array.isArray;function ye(n){return n.length===1&&we(n[0])?n[0]:n}function Se(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var e=ie(n),t=ae(n,1/0);return n=ye(n),T(function(o,i){se(t)(ue(I([o],R(n)),e)).subscribe(i)})}function ge(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return Se.apply(void 0,I([],R(n)))}function Ce(n){n===void 0&&(n={});var r=n.connector,e=r===void 0?function(){return new S}:r,t=n.resetOnError,o=t===void 0?!0:t,i=n.resetOnComplete,s=i===void 0?!0:i,a=n.resetOnRefCountZero,u=a===void 0?!0:a;return function(f){var c,l,v,m=0,w=!1,h=!1,_=function(){l?.unsubscribe(),l=void 0},p=function(){_(),c=v=void 0,w=h=!1},V=function(){var y=c;p(),y?.unsubscribe()};return T(function(y,P){m++,!h&&!w&&_();var g=v=v??e();P.add(function(){m--,m===0&&!h&&!w&&(l=j(V,u))}),g.subscribe(P),!c&&m>0&&(c=new H({next:function(C){return g.next(C)},error:function(C){h=!0,_(),l=j(p,o,C),g.error(C)},complete:function(){w=!0,_(),l=j(p,s),g.complete()}}),W(y).subscribe(c))})(f)}}function j(n,r){for(var e=[],t=2;t<arguments.length;t++)e[t-2]=arguments[t];if(r===!0){n();return}if(r!==!1){var o=new H({next:function(){o.unsubscribe(),n()}});return W(r.apply(void 0,I([],R(e)))).subscribe(o)}}function q(n,r,e){var t,o=!1;return t=n,Ce({connector:function(){return new me(t,r,e)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:o})}function xe(n,r){return T(function(e,t){var o=r??{},i=o.leading,s=i===void 0?!0:i,a=o.trailing,u=a===void 0?!1:a,f=!1,c=null,l=null,v=!1,m=function(){l?.unsubscribe(),l=null,u&&(_(),v&&t.complete())},w=function(){l=null,v&&t.complete()},h=function(p){return l=W(n(p)).subscribe(L(t,m,w))},_=function(){if(f){f=!1;var p=c;c=null,t.next(p),!v&&h(p)}};e.subscribe(L(t,function(p){f=!0,c=p,!(l&&!l.closed)&&(s?_():h(p))},function(){v=!0,!(u&&f&&l&&!l.closed)&&t.complete()}))})}function D(n,r,e){r===void 0&&(r=ce);var t=le(n,r);return xe(function(){return t},e)}new b("TTCGkEskz8Coj1U1UHuNnquQxtm9Cj4hzKvbF5HS6Hm");const Q=$.fromSecretKey(new Uint8Array([237,116,217,235,225,65,118,184,61,252,84,54,210,225,183,101,192,20,197,53,53,64,51,238,234,185,46,54,245,179,181,213,6,133,230,225,205,54,26,36,122,135,26,171,24,141,131,209,52,89,140,19,143,232,99,209,31,120,224,50,221,165,161,227]));new b("526SHGkpwYC5GK3NKMv4QSpAwCrFKjHbbnHs2kkHLus1");new b("HUPFcCmKZFLSyDzrYpJapDDbC5DCwkZkGevbozaEAJf5");new b("3WWrNLibTZsQqnGKNkn4NfKooSsGQGmPRtx5Wdj6BpA2");new b("99qQVnRs9juNhwmr7hcAuGRyYAf1HR6fNiUkFReJaGFD");new b("CCrd6FPk1zu5641ksm4SdXLDiHd2TRd6gSnZCXVrKrMr");new b("CShrvPhcbeLDgSteGgXwJPKDzLNQHbE4WykzSMdQGhYM");const Oe=new K([new d("expiring_time"),new d("max_sol_of_one_order"),new d("token_to_sell_amount"),new d("token_selled_amount"),new d("target_value_in_sol")],"seller"),Ee=new K([new U(32,"last_nonce"),new d("start_time"),new d("expiring_time"),new d("last_reward_time"),new d("reward_per_second"),new d("pending_reward"),new d("count"),new U(16,"mine_diff_ema")],"mine"),je=new K([new pe("is_initialized"),Oe,Ee]);function Z(n){return fe(Y.Buffer.from(n.data),je)}async function Le(n){let r=await n.getAccountInfo(Q.publicKey);return Z(r)}function ke(n,r,e,t,o){const i=6e4*o;return n.pipe(D(1e3),k(()=>N(i).pipe(M(0),ge(r.pipe(D(5*1e3))),k(()=>(console.log(">> query mine state"),e.next(!0),n.value.getAccountInfo(Q.publicKey))),A(a=>(e.next(!1),t.next(Date.now()/1e3|0),a?Z(a):null)),de({delay:.1*i}))))}function Ae(n){return n.pipe(k(e=>{let{start_time:t,last_reward_time:o,pending_reward:i,reward_per_second:s}=e.mine,a=Date.now()/1e3;return a<t?ve(0):N(1e3).pipe(A(u=>u+1),M(0),A(u=>{let f=a+u-o;return(i+f*s)/1e9|0}))}))}let x=window.connectionData;if(!x){let n=new z(new J(X("devnet")));he({}),x={connection:n,wallet:_e()}}const Te=x.connection,Ue=x.wallet,Ie=new S,Re=new z(0),We=new z(!1),Ke=ke(Te,Ie,We,Re,5).pipe(q(1));Ae(Ke).pipe(q(1));export{Ue as $,Le as g};
