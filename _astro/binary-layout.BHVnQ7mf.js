import{b as O}from"./index.browser.esm.C04gqCef.js";var R=function(r,e){return R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])},R(r,e)};function S(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");R(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function xe(r,e,t,n){function o(i){return i instanceof t?i:new t(function(u){u(i)})}return new(t||(t=Promise))(function(i,u){function c(l){try{s(n.next(l))}catch(h){u(h)}}function a(l){try{s(n.throw(l))}catch(h){u(h)}}function s(l){l.done?i(l.value):o(l.value).then(c,a)}s((n=n.apply(r,e||[])).next())})}function N(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u;return u={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function c(s){return function(l){return a([s,l])}}function a(s){if(n)throw new TypeError("Generator is already executing.");for(;u&&(u=0,s[0]&&(t=0)),t;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return t.label++,{value:s[1],done:!1};case 5:t.label++,o=s[1],s=[0];continue;case 7:s=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){t=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){t.label=s[1];break}if(s[0]===6&&t.label<i[1]){t.label=i[1],i=s;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(s);break}i[2]&&t.ops.pop(),t.trys.pop();continue}s=e.call(r,t)}catch(l){s=[6,l],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}function A(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function L(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),o,i=[],u;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(c){u={error:c}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(u)throw u.error}}return i}function z(r,e,t){if(t||arguments.length===2)for(var n=0,o=e.length,i;n<o;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))}function E(r){return this instanceof E?(this.v=r,this):new E(r)}function Ee(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),o,i=[];return o={},u("next"),u("throw"),u("return"),o[Symbol.asyncIterator]=function(){return this},o;function u(f){n[f]&&(o[f]=function(v){return new Promise(function(y,d){i.push([f,v,y,d])>1||c(f,v)})})}function c(f,v){try{a(n[f](v))}catch(y){h(i[0][3],y)}}function a(f){f.value instanceof E?Promise.resolve(f.value.v).then(s,l):h(i[0][2],f)}function s(f){c("next",f)}function l(f){c("throw",f)}function h(f,v){f(v),i.shift(),i.length&&c(i[0][0],i[0][1])}}function Ae(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof A=="function"?A(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=r[i]&&function(u){return new Promise(function(c,a){u=r[i](u),o(c,a,u.done,u.value)})}}function o(i,u,c,a){Promise.resolve(a).then(function(s){i({value:s,done:c})},u)}}function p(r){return typeof r=="function"}function ee(r){var e=function(n){Error.call(n),n.stack=new Error().stack},t=r(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var F=ee(function(r){return function(t){r(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(n,o){return o+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function j(r,e){if(r){var t=r.indexOf(e);0<=t&&r.splice(t,1)}}var P=function(){function r(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return r.prototype.unsubscribe=function(){var e,t,n,o,i;if(!this.closed){this.closed=!0;var u=this._parentage;if(u)if(this._parentage=null,Array.isArray(u))try{for(var c=A(u),a=c.next();!a.done;a=c.next()){var s=a.value;s.remove(this)}}catch(d){e={error:d}}finally{try{a&&!a.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}else u.remove(this);var l=this.initialTeardown;if(p(l))try{l()}catch(d){i=d instanceof F?d.errors:[d]}var h=this._finalizers;if(h){this._finalizers=null;try{for(var f=A(h),v=f.next();!v.done;v=f.next()){var y=v.value;try{W(y)}catch(d){i=i??[],d instanceof F?i=z(z([],L(i)),L(d.errors)):i.push(d)}}}catch(d){n={error:d}}finally{try{v&&!v.done&&(o=f.return)&&o.call(f)}finally{if(n)throw n.error}}}if(i)throw new F(i)}},r.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)W(e);else{if(e instanceof r){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},r.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},r.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},r.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&j(t,e)},r.prototype.remove=function(e){var t=this._finalizers;t&&j(t,e),e instanceof r&&e._removeParent(this)},r.EMPTY=function(){var e=new r;return e.closed=!0,e}(),r}(),te=P.EMPTY;function re(r){return r instanceof P||r&&"closed"in r&&p(r.remove)&&p(r.add)&&p(r.unsubscribe)}function W(r){p(r)?r():r.unsubscribe()}var ne={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},oe={setTimeout:function(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];return setTimeout.apply(void 0,z([r,e],L(t)))},clearTimeout:function(r){var e=oe.delegate;return(e?.clearTimeout||clearTimeout)(r)},delegate:void 0};function ie(r){oe.setTimeout(function(){throw r})}function J(){}function U(r){r()}var V=function(r){S(e,r);function e(t){var n=r.call(this)||this;return n.isStopped=!1,t?(n.destination=t,re(t)&&t.add(n)):n.destination=ke,n}return e.create=function(t,n,o){return new $(t,n,o)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,r.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(P),Oe=Function.prototype.bind;function C(r,e){return Oe.call(r,e)}var Pe=function(){function r(e){this.partialObserver=e}return r.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(n){k(n)}},r.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(n){k(n)}else k(e)},r.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){k(t)}},r}(),$=function(r){S(e,r);function e(t,n,o){var i=r.call(this)||this,u;if(p(t)||!t)u={next:t??void 0,error:n??void 0,complete:o??void 0};else{var c;i&&ne.useDeprecatedNextContext?(c=Object.create(t),c.unsubscribe=function(){return i.unsubscribe()},u={next:t.next&&C(t.next,c),error:t.error&&C(t.error,c),complete:t.complete&&C(t.complete,c)}):u=t}return i.destination=new Pe(u),i}return e}(V);function k(r){ie(r)}function Te(r){throw r}var ke={closed:!0,next:J,error:Te,complete:J},q=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Y(r){return r}function Ue(r){return r.length===0?Y:r.length===1?r[0]:function(t){return r.reduce(function(n,o){return o(n)},t)}}var b=function(){function r(e){e&&(this._subscribe=e)}return r.prototype.lift=function(e){var t=new r;return t.source=this,t.operator=e,t},r.prototype.subscribe=function(e,t,n){var o=this,i=ze(e)?e:new $(e,t,n);return U(function(){var u=o,c=u.operator,a=u.source;i.add(c?c.call(i,a):a?o._subscribe(i):o._trySubscribe(i))}),i},r.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},r.prototype.forEach=function(e,t){var n=this;return t=K(t),new t(function(o,i){var u=new $({next:function(c){try{e(c)}catch(a){i(a),u.unsubscribe()}},error:i,complete:o});n.subscribe(u)})},r.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},r.prototype[q]=function(){return this},r.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ue(e)(this)},r.prototype.toPromise=function(e){var t=this;return e=K(e),new e(function(n,o){var i;t.subscribe(function(u){return i=u},function(u){return o(u)},function(){return n(i)})})},r.create=function(e){return new r(e)},r}();function K(r){var e;return(e=r??ne.Promise)!==null&&e!==void 0?e:Promise}function Le(r){return r&&p(r.next)&&p(r.error)&&p(r.complete)}function ze(r){return r&&r instanceof V||Le(r)&&re(r)}function je(r){return p(r?.lift)}function I(r){return function(e){if(je(e))return e.lift(function(t){try{return r(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function g(r,e,t,n,o){return new Be(r,e,t,n,o)}var Be=function(r){S(e,r);function e(t,n,o,i,u,c){var a=r.call(this,t)||this;return a.onFinalize=u,a.shouldUnsubscribe=c,a._next=n?function(s){try{n(s)}catch(l){t.error(l)}}:r.prototype._next,a._error=i?function(s){try{i(s)}catch(l){t.error(l)}finally{this.unsubscribe()}}:r.prototype._error,a._complete=o?function(){try{o()}catch(s){t.error(s)}finally{this.unsubscribe()}}:r.prototype._complete,a}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;r.prototype.unsubscribe.call(this),!n&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(V),Fe=ee(function(r){return function(){r(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Ce=function(r){S(e,r);function e(){var t=r.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var n=new Q(this,this);return n.operator=t,n},e.prototype._throwIfClosed=function(){if(this.closed)throw new Fe},e.prototype.next=function(t){var n=this;U(function(){var o,i;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var u=A(n.currentObservers),c=u.next();!c.done;c=u.next()){var a=c.value;a.next(t)}}catch(s){o={error:s}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(o)throw o.error}}}})},e.prototype.error=function(t){var n=this;U(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=t;for(var o=n.observers;o.length;)o.shift().error(t)}})},e.prototype.complete=function(){var t=this;U(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var n=t.observers;n.length;)n.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),r.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var n=this,o=this,i=o.hasError,u=o.isStopped,c=o.observers;return i||u?te:(this.currentObservers=null,c.push(t),new P(function(){n.currentObservers=null,j(c,t)}))},e.prototype._checkFinalizedStatuses=function(t){var n=this,o=n.hasError,i=n.thrownError,u=n.isStopped;o?t.error(i):u&&t.complete()},e.prototype.asObservable=function(){var t=new b;return t.source=this,t},e.create=function(t,n){return new Q(t,n)},e}(b),Q=function(r){S(e,r);function e(t,n){var o=r.call(this)||this;return o.destination=t,o.source=n,o}return e.prototype.next=function(t){var n,o;(o=(n=this.destination)===null||n===void 0?void 0:n.next)===null||o===void 0||o.call(n,t)},e.prototype.error=function(t){var n,o;(o=(n=this.destination)===null||n===void 0?void 0:n.error)===null||o===void 0||o.call(n,t)},e.prototype.complete=function(){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||n===void 0||n.call(t)},e.prototype._subscribe=function(t){var n,o;return(o=(n=this.source)===null||n===void 0?void 0:n.subscribe(t))!==null&&o!==void 0?o:te},e}(Ce),ue={now:function(){return(ue.delegate||Date).now()},delegate:void 0},Re=function(r){S(e,r);function e(t,n){return r.call(this)||this}return e.prototype.schedule=function(t,n){return this},e}(P),D={setInterval:function(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];return setInterval.apply(void 0,z([r,e],L(t)))},clearInterval:function(r){var e=D.delegate;return(e?.clearInterval||clearInterval)(r)},delegate:void 0},$e=function(r){S(e,r);function e(t,n){var o=r.call(this,t,n)||this;return o.scheduler=t,o.work=n,o.pending=!1,o}return e.prototype.schedule=function(t,n){var o;if(n===void 0&&(n=0),this.closed)return this;this.state=t;var i=this.id,u=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(u,i,n)),this.pending=!0,this.delay=n,this.id=(o=this.id)!==null&&o!==void 0?o:this.requestAsyncId(u,this.id,n),this},e.prototype.requestAsyncId=function(t,n,o){return o===void 0&&(o=0),D.setInterval(t.flush.bind(t,this),o)},e.prototype.recycleAsyncId=function(t,n,o){if(o===void 0&&(o=0),o!=null&&this.delay===o&&this.pending===!1)return n;n!=null&&D.clearInterval(n)},e.prototype.execute=function(t,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var o=this._execute(t,n);if(o)return o;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,n){var o=!1,i;try{this.work(t)}catch(u){o=!0,i=u||new Error("Scheduled action threw falsy error")}if(o)return this.unsubscribe(),i},e.prototype.unsubscribe=function(){if(!this.closed){var t=this,n=t.id,o=t.scheduler,i=o.actions;this.work=this.state=this.scheduler=null,this.pending=!1,j(i,this),n!=null&&(this.id=this.recycleAsyncId(o,n,null)),this.delay=null,r.prototype.unsubscribe.call(this)}},e}(Re),X=function(){function r(e,t){t===void 0&&(t=r.now),this.schedulerActionCtor=e,this.now=t}return r.prototype.schedule=function(e,t,n){return t===void 0&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},r.now=ue.now,r}(),De=function(r){S(e,r);function e(t,n){n===void 0&&(n=X.now);var o=r.call(this,t,n)||this;return o.actions=[],o._active=!1,o}return e.prototype.flush=function(t){var n=this.actions;if(this._active){n.push(t);return}var o;this._active=!0;do if(o=t.execute(t.state,t.delay))break;while(t=n.shift());if(this._active=!1,o){for(;t=n.shift();)t.unsubscribe();throw o}},e}(X),M=new De($e),Ve=M;function se(r){return r&&p(r.schedule)}function ce(r){return r[r.length-1]}function G(r){return se(ce(r))?r.pop():void 0}function ft(r,e){return typeof ce(r)=="number"?r.pop():e}var ae=function(r){return r&&typeof r.length=="number"&&typeof r!="function"};function le(r){return p(r?.then)}function fe(r){return p(r[q])}function he(r){return Symbol.asyncIterator&&p(r?.[Symbol.asyncIterator])}function de(r){return new TypeError("You provided "+(r!==null&&typeof r=="object"?"an invalid object":"'"+r+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function qe(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var ve=qe();function pe(r){return p(r?.[ve])}function ye(r){return Ee(this,arguments,function(){var t,n,o,i;return N(this,function(u){switch(u.label){case 0:t=r.getReader(),u.label=1;case 1:u.trys.push([1,,9,10]),u.label=2;case 2:return[4,E(t.read())];case 3:return n=u.sent(),o=n.value,i=n.done,i?[4,E(void 0)]:[3,5];case 4:return[2,u.sent()];case 5:return[4,E(o)];case 6:return[4,u.sent()];case 7:return u.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function be(r){return p(r?.getReader)}function x(r){if(r instanceof b)return r;if(r!=null){if(fe(r))return Ye(r);if(ae(r))return Me(r);if(le(r))return Ge(r);if(he(r))return me(r);if(pe(r))return He(r);if(be(r))return We(r)}throw de(r)}function Ye(r){return new b(function(e){var t=r[q]();if(p(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Me(r){return new b(function(e){for(var t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()})}function Ge(r){return new b(function(e){r.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,ie)})}function He(r){return new b(function(e){var t,n;try{for(var o=A(r),i=o.next();!i.done;i=o.next()){var u=i.value;if(e.next(u),e.closed)return}}catch(c){t={error:c}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}e.complete()})}function me(r){return new b(function(e){Je(r,e).catch(function(t){return e.error(t)})})}function We(r){return me(ye(r))}function Je(r,e){var t,n,o,i;return xe(this,void 0,void 0,function(){var u,c;return N(this,function(a){switch(a.label){case 0:a.trys.push([0,5,6,11]),t=Ae(r),a.label=1;case 1:return[4,t.next()];case 2:if(n=a.sent(),!!n.done)return[3,4];if(u=n.value,e.next(u),e.closed)return[2];a.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=a.sent(),o={error:c},[3,11];case 6:return a.trys.push([6,,9,10]),n&&!n.done&&(i=t.return)?[4,i.call(t)]:[3,8];case 7:a.sent(),a.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function _(r,e,t,n,o){n===void 0&&(n=0),o===void 0&&(o=!1);var i=e.schedule(function(){t(),o?r.add(this.schedule(null,n)):this.unsubscribe()},n);if(r.add(i),!o)return i}function we(r,e){return e===void 0&&(e=0),I(function(t,n){t.subscribe(g(n,function(o){return _(n,r,function(){return n.next(o)},e)},function(){return _(n,r,function(){return n.complete()},e)},function(o){return _(n,r,function(){return n.error(o)},e)}))})}function ge(r,e){return e===void 0&&(e=0),I(function(t,n){n.add(r.schedule(function(){return t.subscribe(n)},e))})}function Ke(r,e){return x(r).pipe(ge(e),we(e))}function Qe(r,e){return x(r).pipe(ge(e),we(e))}function Xe(r,e){return new b(function(t){var n=0;return e.schedule(function(){n===r.length?t.complete():(t.next(r[n++]),t.closed||this.schedule())})})}function Ze(r,e){return new b(function(t){var n;return _(t,e,function(){n=r[ve](),_(t,e,function(){var o,i,u;try{o=n.next(),i=o.value,u=o.done}catch(c){t.error(c);return}u?t.complete():t.next(i)},0,!0)}),function(){return p(n?.return)&&n.return()}})}function Se(r,e){if(!r)throw new Error("Iterable cannot be null");return new b(function(t){_(t,e,function(){var n=r[Symbol.asyncIterator]();_(t,e,function(){n.next().then(function(o){o.done?t.complete():t.next(o.value)})},0,!0)})})}function Ne(r,e){return Se(ye(r),e)}function et(r,e){if(r!=null){if(fe(r))return Ke(r,e);if(ae(r))return Xe(r,e);if(le(r))return Qe(r,e);if(he(r))return Se(r,e);if(pe(r))return Ze(r,e);if(be(r))return Ne(r,e)}throw de(r)}function _e(r,e){return e?et(r,e):x(r)}function ht(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var t=G(r);return _e(r,t)}function tt(r){return r instanceof Date&&!isNaN(r)}function rt(r,e){return I(function(t,n){var o=0;t.subscribe(g(n,function(i){n.next(r.call(e,i,o++))}))})}function nt(r,e,t,n,o,i,u,c){var a=[],s=0,l=0,h=!1,f=function(){h&&!a.length&&!s&&e.complete()},v=function(d){return s<n?y(d):a.push(d)},y=function(d){s++;var w=!1;x(t(d,l++)).subscribe(g(e,function(m){e.next(m)},function(){w=!0},void 0,function(){if(w)try{s--;for(var m=function(){var B=a.shift();u||y(B)};a.length&&s<n;)m();f()}catch(B){e.error(B)}}))};return r.subscribe(g(e,v,function(){h=!0,f()})),function(){}}function Ie(r,e,t){return t===void 0&&(t=1/0),p(e)?Ie(function(n,o){return rt(function(i,u){return e(n,i,o,u)})(x(r(n,o)))},t):(typeof e=="number"&&(t=e),I(function(n,o){return nt(n,o,r,t)}))}function ot(r){return r===void 0&&(r=1/0),Ie(Y,r)}function it(){return ot(1)}function Z(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return it()(_e(r,G(r)))}function H(r,e,t){r===void 0&&(r=0),t===void 0&&(t=Ve);var n=-1;return e!=null&&(se(e)?t=e:n=e),new b(function(o){var i=tt(r)?+r-t.now():r;i<0&&(i=0);var u=0;return t.schedule(function(){o.closed||(o.next(u++),0<=n?this.schedule(void 0,n):o.complete())},i)})}function dt(r,e){return r===void 0&&(r=0),e===void 0&&(e=M),r<0&&(r=0),H(r,r,e)}function vt(r){r===void 0&&(r=1/0);var e;r&&typeof r=="object"?e=r:e={count:r};var t=e.count,n=t===void 0?1/0:t,o=e.delay,i=e.resetOnSuccess,u=i===void 0?!1:i;return n<=0?Y:I(function(c,a){var s=0,l,h=function(){var f=!1;l=c.subscribe(g(a,function(v){u&&(s=0),a.next(v)},void 0,function(v){if(s++<n){var y=function(){l?(l.unsubscribe(),l=null,h()):f=!0};if(o!=null){var d=typeof o=="number"?H(o):x(o(v,s)),w=g(a,function(){w.unsubscribe(),y()},function(){a.complete()});d.subscribe(w)}else y()}else a.error(v)})),f&&(l.unsubscribe(),l=null,h())};h()})}function pt(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var t=G(r);return I(function(n,o){(t?Z(r,n,t):Z(r,n)).subscribe(o)})}function ut(r,e){return I(function(t,n){var o=e??{},i=o.leading,u=i===void 0?!0:i,c=o.trailing,a=c===void 0?!1:c,s=!1,l=null,h=null,f=!1,v=function(){h?.unsubscribe(),h=null,a&&(w(),f&&n.complete())},y=function(){h=null,f&&n.complete()},d=function(m){return h=x(r(m)).subscribe(g(n,v,y))},w=function(){if(s){s=!1;var m=l;l=null,n.next(m),!f&&d(m)}};t.subscribe(g(n,function(m){s=!0,l=m,!(h&&!h.closed)&&(u?w():d(m))},function(){f=!0,!(a&&s&&h&&!h.closed)&&n.complete()}))})}function yt(r,e,t){e===void 0&&(e=M);var n=H(r,e);return ut(function(){return n},t)}function T(r,e){if(!r)throw new Error("assert "+e)}class bt{constructor(e,t){this.size=e,this.name=t}getSize(e){return this.size}encode(e,t){return e.copy(t,0)}decode(e){return[O.Buffer.from(e.slice(0,this.size)),this.size]}}class st{constructor(e){this.name=e}getSize(e){return e?4+e.length:4}encode(e,t){return e?(t.writeUInt32LE(e.length),e.copy(t,4),4+e.length):(t.writeUInt32LE(0),4)}decode(e){const t=e.readUInt32LE();return t==0?[O.Buffer.from([]),4]:[O.Buffer.from(e.slice(4,4+t)),4+t]}}class ct{constructor(e){this.name=e,this.l=new st(e)}l;getSize(e){return this.l.getSize(this.encode_to_buffer(e))}encode(e,t){return this.l.encode(this.encode_to_buffer(e),t)}decode(e){const[t,n]=this.l.decode(e);return[this.decode_from_buffer(t),n]}}class mt extends ct{encode_to_buffer(e){return O.Buffer.from(e)}decode_from_buffer(e){return e.toString()}}class at{constructor(e){this.name=e}getSize(e){return 1}encode(e,t){if(e>255)throw new Error(`u8 plug ${this.name} encode error, value must in [0, 255], but got ${e}`);return t.set([e],0),1}decode(e){return T(e.length>0),[e.at(0),1]}}class wt{constructor(e){this.name=e}getSize(e){return 1}encode(e,t){return t.set([e?1:0],0),1}decode(e){return T(e.length>0),[!!e.at(0),1]}}class gt{constructor(e){this.name=e}getSize(e){return 8}encode(e,t){return t.writeBigUint64LE(BigInt(e)),8}decode(e){T(e.length>=8);let t=e.readBigUInt64LE();return[Number(t),8]}}class St extends at{constructor(e,t){super(t),this.v=e,this.name=t}encode(e,t){return this.v!==e&&console.warn(`const u8 layout is ${this.v}, the input value ${e} will be ignored.`),super.encode(this.v,t)}decode(e){const[t,n]=super.decode(e);return this.v!==t&&console.warn(`const u8 layout is ${this.v}, the decoded value ${t} will be ignored.`),[this.v,1]}}class _t{constructor(e,t){this.layout_arr=e,this.name=t}getSize(e){let t=0;for(let n=0;n<this.layout_arr.length;n++){const o=this.layout_arr[n];if(o.name){const i=o.getSize(e[o.name]);t+=i}else throw new Error("unnamed layout")}return t}encode(e,t){let n=0;for(let o=0;o<this.layout_arr.length;o++){const i=this.layout_arr[o];if(i.name){const u=i.encode(e[i.name],t);n+=u,t=t.slice(u)}else throw new Error("unnamed layout")}return n}decode(e){const t={};let n=0;for(let o=0,i=e;o<this.layout_arr.length;o++){const u=this.layout_arr[o];if(u.name){const[c,a]=u.decode(i);t[u.name]=c,i=i.slice(a),n+=a}else throw new Error("unnamed layout")}return[t,n]}}function It(r,e){const t=e.getSize(r),n=O.Buffer.alloc(t),o=e.encode(r,n);return T(t==o,`encoded length must equel to calculated size.size: ${t}, len: ${o}`),n}function xt(r,e){const[t,n]=e.decode(r);return T(r.length==n,"decoded length must equal to input buffer length."),t}export{wt as B,St as C,bt as F,_t as O,Ce as S,gt as U,S as _,ft as a,z as b,L as c,ue as d,$ as e,_e as f,g,dt as h,x as i,rt as j,ht as k,T as l,ot as m,mt as n,I as o,G as p,xe as q,vt as r,pt as s,yt as t,xt as u,N as v,It as w};
