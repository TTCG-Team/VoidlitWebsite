import"./NavBar.astro_astro_type_script_index_0_lang.CNq-JdqT.js";import"https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.10.2/umd/popper.min.js";import{T as m,a as p}from"./PopupWindow.astro_astro_type_script_index_0_lang.NIR90ugl.js";import"./_commonjsHelpers.BosuxZz1.js";let c=!1;function f(e){let t=window.scrollY,s=Math.ceil(t/window.innerHeight);window.scrollTo(0,window.innerHeight*(s+e)),c=!0,setTimeout(()=>{c=!1},600)}window.addEventListener("wheel",e=>{if(!c){let t=0;e.deltaY<0?t=-1:e.deltaY>0&&(t=1),f(t)}e.stopImmediatePropagation()});let h,u;window.addEventListener("touchstart",e=>{h=e.touches[0],u=Date.now()});const a=e=>{h=null};window.addEventListener("touchcancel",a);window.addEventListener("touchend",a);window.addEventListener("touchmove",e=>{if(Date.now()-u>400)return;let t;if(h){for(let s of e.touches)if(s.identifier===h.identifier){t=s;break}}if(t){let s=t.pageY-h.pageY;s>100?(f(-1),a()):s<-100&&(f(1),a())}});class l{static _percent=.5;static set percent(t){this._percent!==t&&(this._percent=t,l.updateAll())}static get percent(){return this._percent}static _tween;static animatePercent(t){this._tween?.stop(),this._tween=new m(this).to({percent:t},900).start()}static views=[];element;left;right;constructor(t){this.element=t;let s=t.children;for(let n of s)n.nodeName.toLowerCase()==="div"&&(this.left?this.right||(this.right=n):this.left=n);this.right.style.flexGrow="1",l.views.push(this),this._update()}_update(){let t=this.element.getBoundingClientRect();this.left.style.width=`${t.width*l.percent}px`,this.right.style.maxWidth=`${t.width*(1-l.percent)}px`}static updateAll(){for(let t of l.views)t._update()}}window.addEventListener("resize",()=>{l.updateAll()});let r=[],w=()=>{let e,t,s=null;for(let n=0,o=r.length;n<o;++n){let i=r[n];i.onscroll();let d=Math.abs(i.offset);(s===null||s>d)&&(s=d,e=i,i.offset>0&&n>=0?t=r[n-1]:i.offset<0?t=r[n+1]:t=null)}if(e){let n=Math.max(1-Math.abs(e.offset)/window.innerHeight,.01),o=e.percent;t&&(o=o*n+t.percent*(1-n)),l.animatePercent(o)}};document.addEventListener("scroll",w);class g{element;inner;_oldTime=0;_rect;_isShow=!1;percent=.5;offset;constructor(t){this.element=t,this.percent=parseFloat(t.dataset.percent),this.inner=t.querySelector(".fade-in-inner"),r.push(this),this.onscroll()}set isShow(t){this._isShow!==t&&(this._isShow=t,t?this.element.classList.add("display"):this.element.classList.remove("display"))}get isShow(){return this._isShow}onscroll(){this._testUpdate();let t=(this._rect.top+this._rect.bottom)/2;this.offset=window.innerHeight/2-t,this.inner.style.transform=`translate(0, ${-this.offset/4}px)`,this.element.style.opacity=`${Math.min(1,(1-Math.abs(this.offset/window.innerHeight))*1.4)}`}_testUpdate(){let t=Date.now(),s=this.element.getBoundingClientRect();this._rect=s,this._oldTime=t}}window.addEventListener("load",w);let _=document.querySelectorAll(".fade-in-item");for(let e of _)new g(e);class v{element;canvas;details;dots;transition;indexElement;constructor(t){let s=t.parentElement;this.canvas=s.querySelector(".transition"),this.element=t,this.indexElement=t.querySelector(".control-index > div"),this.transition=new p(this.canvas,["/imgs/arts/pic_web_01.jpg","/imgs/arts/pic_web_02.jpg","/imgs/arts/pic_web_03.jpg"],"/imgs/summary/dis.jpg",{duration:1200}),this.details=[];for(let i of t.querySelectorAll(".summary-details"))this.details.push(i);this.dots=[];for(let i of s.querySelectorAll(".dots .dot"))this.dots.push(i);for(let i=0,d=this.dots.length;i<d;++i)this.dots[i].onclick=()=>{this.selected=i};t.querySelector(".control-arrow .left").addEventListener("click",()=>{let i=this.selected-1;i<0&&(i+=this.length),this.selected=i}),t.querySelector(".control-arrow .right").addEventListener("click",()=>{this.selected=(this.selected+1)%this.length}),this.selected=0}get length(){return this.details.length}_tween;_selected;set selected(t){if(this._selected!==t){typeof this._selected=="number"&&(this.dots[this._selected].classList.remove("selected"),this.details[this._selected].classList.remove("selected"));let s=this._selected||0;this.indexElement.innerText=`${t+1}/${this.length}`,this._selected=t,this.dots[t].classList.add("selected"),this.details[t].classList.add("selected"),this.setTimeout(),this.transition.setImage(s,t),this.transition.progress=0,this.transition.draw(),this._tween?.stop(),this._tween=new m(this.transition).to({progress:1},900).onUpdate(()=>{this.transition.draw()}).start()}}get selected(){return this._selected}_timeout;setTimeout(){clearTimeout(this._timeout)}}for(let e of document.querySelectorAll(".summary"))new v(e);class y{element;milestones;constructor(t){this.element=t,t.addEventListener("mousedown",this.touchstart.bind(this)),t.addEventListener("touchstart",this.touchstart.bind(this)),t.addEventListener("mousemove",this.touchmove.bind(this)),t.addEventListener("touchmove",this.touchmove.bind(this)),window.addEventListener("mouseup",this.touchend.bind(this)),t.addEventListener("touchend",this.touchend.bind(this)),t.addEventListener("touchcancel",this.touchend.bind(this)),this.milestones=[];let s=!0,n=0;for(let o of this.element.querySelectorAll(".milestone")){let i=o;this.milestones.push(i),s&&i.classList.add("done"),i.classList.contains("selected")&&(s=!1,n=i.offsetLeft+i.clientWidth/2-this.element.clientWidth/2,this.element.scrollTo({left:n}))}}_dragging=!1;_pointer={x:0,y:0};_oldX;makePointer(t){t instanceof MouseEvent?this._pointer={x:t.screenX,y:t.screenY}:t instanceof TouchEvent&&(this._pointer={x:t.touches[0].screenX,y:t.touches[0].screenY})}touchstart(t){this._dragging||(this._dragging=!0,this.makePointer(t),this._oldX=this.element.scrollLeft)}touchmove(t){if(this._dragging){let s=this._pointer.x;this.makePointer(t);let n=s-this._pointer.x;if(n>0){let o=this.element.scrollWidth-this.element.clientWidth;this._oldX<o&&(this._oldX+=n),this._oldX>o&&(this._oldX=o),console.log(this._oldX),this.element.scrollTo({left:this._oldX})}else n<0&&(this._oldX>0&&(this._oldX+=n),this._oldX<0&&(this._oldX=0),this.element.scrollTo({left:this._oldX}))}}touchend(t){this._dragging&&(this._dragging=!1)}}for(let e of document.querySelectorAll(".road-map > .map"))new y(e);let L=document.querySelectorAll(".split-view");for(let e of L)new l(e);
